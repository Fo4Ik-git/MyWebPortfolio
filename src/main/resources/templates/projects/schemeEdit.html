<!DOCTYPE html>
<html lang="en">
<head th:insert="~{fragments/head :: head}"/>
<body>
<header th:insert="~{fragments/menu :: menu}"></header>

<div class="container mt-5 mb-5" th:each="el : ${schemes}">
    <div th:if="${userName == el.userName} or ${isModerator}">
        <h1>Edit element</h1>
        <form method="post" th:action="@{/templates/projects/{id}/edit(id=${scheme.getId()})}" enctype="multipart/form-data">
            <!--<h1 th:text="@{/scheme/{id}/edit}"></h1>-->
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" th:value="${el.name}" class="form-control" id="name" name="name"
                       placeholder="Enter name">
            </div>
            <div class="form-group">
                <label for="description">Description <span id="count">(1000)</span></label>
                <p><textarea th:text="${el.description}" maxlength="1000" class="form-control" id="description"
                             name="description" placeholder="Enter description"></textarea></p>
            </div>
            <div class="form-group">
                <label for="schemeText">Text to copy scheme (Optional)</label>
                <p><textarea th:text="${el.schemeText}" class="form-control" id="schemeText" name="schemeText"
                             placeholder="Enter description"></textarea></p>
            </div>
            <!--<input type="file" name="logoFile" id="logoFile">-->
            <br>
            <div class="container">
                <div class="row">
                    <button type="submit" value="Upload" class="btn btn-primary">Update</button>
                    <a th:href="'/scheme'" class="btn btn-warning mt-1">Back</a>
                </div>
            </div>
        </form>
    </div>

    <div th:unless="${userName == el.userName} or ${userRole == 'MODERATOR'}">
        <h1>That's not your post</h1>
        <a th:href="'/scheme'" class="btn btn-warning mt-1">Back</a>
    </div>

</div>

<div class="modal" tabindex="-1" role="dialog" id="errorModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Ошибка</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Произошла ошибка: <span id="errorMessage"></span></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script>
    function showErrorModal(errorMessage) {
        $("#errorMessage").text(errorMessage);
        $("#errorModal").modal('show');
    }
</script>


<script>
    const textarea = document.querySelector("#description");
    const count = document.querySelector("#count");

    textarea.addEventListener("input", function () {
        count.innerText = `(${1000 - textarea.value.length})`;
    });
</script>
<div th:insert="~{fragments/js :: js}"/>
</body>
</html>